import{c as Tn,l as Nn,m as Cn,a as p,d as j,f as U,o as Fe,j as On}from"../chunks/W4OKvgJ1.js";import{w as yt,o as Zt,a as An}from"../chunks/sST61MHv.js";import{a as ft,H as Qt,aW as en,S as et,h as pe,a0 as tn,I as ht,l as s,ap as xn,af as Dn,K as Pn,U as Rt,a4 as dt,e as Be,J as Un,a9 as Ln,R as Ht,c as zn,aX as Ue,b as Ct,s as Rn,C as jt,ag as C,a7 as At,aM as Hn,aY as jn,aZ as Fn,a_ as qn,r as nn,p as sn,a$ as Tt,F as Vn,a2 as Bn,b0 as Jn,a6 as Gn,d as Wn,b1 as Kn,X as Yn,b2 as Xn,G as Zn,ah as Qn,t as we,x as ke,A as E,y as f,i as B,n as A,z as v,v as O,aJ as me,b3 as an,b4 as H,b5 as xe,w as Q,ai as N,aH as Ft,an as es,T as ts}from"../chunks/DCd_uAEE.js";import{s as P}from"../chunks/mw6dDeEP.js";import{l as ne,p as z,s as re,i as J,a as Ee,b as fe,c as rn}from"../chunks/CUWMNtGJ.js";import{a as qt,b as Ae,s as ut,c as ns,d as ss}from"../chunks/CCIW6Yut.js";import"../chunks/DNsPaE8R.js";import{i as Se}from"../chunks/BQsvaV8x.js";import{B as as}from"../chunks/-W29c7Qh.js";function tt(n,e){return e}function rs(n,e,a){for(var i=[],r=e.length,o,t=e.length,l=0;l<r;l++){let u=e[l];sn(u,()=>{if(o){if(o.pending.delete(u),o.done.add(u),o.pending.size===0){var _=n.outrogroups;Ot(At(o.done)),_.delete(o),_.size===0&&(n.outrogroups=null)}}else t-=1},!1)}if(t===0){var c=i.length===0&&a!==null;if(c){var d=a,g=d.parentNode;Gn(g),g.append(d),n.items.clear()}Ot(e,!c)}else o={pending:new Set(e),done:new Set},(n.outrogroups??=new Set).add(o)}function Ot(n,e=!0){for(var a=0;a<n.length;a++)Wn(n[a],e)}var Vt;function nt(n,e,a,i,r,o=null){var t=n,l=new Map,c=(e&en)!==0;if(c){var d=n;t=pe?et(tn(d)):d.appendChild(ft())}pe&&ht();var g=null,u=xn(()=>{var b=a();return Hn(b)?b:b==null?[]:At(b)}),_,$=!0;function w(){h.fallback=g,is(h,_,t,e,i),g!==null&&(_.length===0?(g.f&Ue)===0?nn(g):(g.f^=Ue,ct(g,null,t)):sn(g,()=>{g=null}))}var I=Qt(()=>{_=s(u);var b=_.length;let V=!1;if(pe){var te=Dn(t)===Pn;te!==(b===0)&&(t=Rt(),et(t),dt(!1),V=!0)}for(var q=new Set,se=zn,oe=Rn(),Y=0;Y<b;Y+=1){pe&&Be.nodeType===Un&&Be.data===Ln&&(t=Be,V=!0,dt(!1));var ce=_[Y],ee=i(ce,Y),X=$?null:l.get(ee);X?(X.v&&Ht(X.v,ce),X.i&&Ht(X.i,Y),oe&&se.skipped_effects.delete(X.e)):(X=os(l,$?t:Vt??=ft(),ce,ee,Y,r,e,a),$||(X.e.f|=Ue),l.set(ee,X)),q.add(ee)}if(b===0&&o&&!g&&($?g=Ct(()=>o(t)):(g=Ct(()=>o(Vt??=ft())),g.f|=Ue)),pe&&b>0&&et(Rt()),!$)if(oe){for(const[S,k]of l)q.has(S)||se.skipped_effects.add(k.e);se.oncommit(w),se.ondiscard(()=>{})}else w();V&&dt(!0),s(u)}),h={effect:I,items:l,outrogroups:null,fallback:g};$=!1,pe&&(t=Be)}function is(n,e,a,i,r){var o=(i&Jn)!==0,t=e.length,l=n.items,c=n.effect.first,d,g=null,u,_=[],$=[],w,I,h,b;if(o)for(b=0;b<t;b+=1)w=e[b],I=r(w,b),h=l.get(I).e,(h.f&Ue)===0&&(h.nodes?.a?.measure(),(u??=new Set).add(h));for(b=0;b<t;b+=1){if(w=e[b],I=r(w,b),h=l.get(I).e,n.outrogroups!==null)for(const X of n.outrogroups)X.pending.delete(h),X.done.delete(h);if((h.f&Ue)!==0)if(h.f^=Ue,h===c)ct(h,null,a);else{var V=g?g.next:c;h===n.effect.last&&(n.effect.last=h.prev),h.prev&&(h.prev.next=h.next),h.next&&(h.next.prev=h.prev),je(n,g,h),je(n,h,V),ct(h,V,a),g=h,_=[],$=[],c=g.next;continue}if((h.f&Tt)!==0&&(nn(h),o&&(h.nodes?.a?.unfix(),(u??=new Set).delete(h))),h!==c){if(d!==void 0&&d.has(h)){if(_.length<$.length){var te=$[0],q;g=te.prev;var se=_[0],oe=_[_.length-1];for(q=0;q<_.length;q+=1)ct(_[q],te,a);for(q=0;q<$.length;q+=1)d.delete($[q]);je(n,se.prev,oe.next),je(n,g,se),je(n,oe,te),c=te,g=oe,b-=1,_=[],$=[]}else d.delete(h),ct(h,c,a),je(n,h.prev,h.next),je(n,h,g===null?n.effect.first:g.next),je(n,g,h),g=h;continue}for(_=[],$=[];c!==null&&c!==h;)(d??=new Set).add(c),$.push(c),c=c.next;if(c===null)continue}(h.f&Ue)===0&&_.push(h),g=h,c=h.next}if(n.outrogroups!==null){for(const X of n.outrogroups)X.pending.size===0&&(Ot(At(X.done)),n.outrogroups?.delete(X));n.outrogroups.size===0&&(n.outrogroups=null)}if(c!==null||d!==void 0){var Y=[];if(d!==void 0)for(h of d)(h.f&Tt)===0&&Y.push(h);for(;c!==null;)(c.f&Tt)===0&&c!==n.fallback&&Y.push(c),c=c.next;var ce=Y.length;if(ce>0){var ee=(i&en)!==0&&t===0?a:null;if(o){for(b=0;b<ce;b+=1)Y[b].nodes?.a?.measure();for(b=0;b<ce;b+=1)Y[b].nodes?.a?.fix()}rs(n,Y,ee)}}o&&Vn(()=>{if(u!==void 0)for(h of u)h.nodes?.a?.apply()})}function os(n,e,a,i,r,o,t,l){var c=(t&jn)!==0?(t&Fn)===0?C(a,!1,!1):jt(a):null,d=(t&qn)!==0?jt(r):null;return{v:c,i:d,e:Ct(()=>(o(e,c??a,d??r,l),()=>{n.delete(i)}))}}function ct(n,e,a){if(n.nodes)for(var i=n.nodes.start,r=n.nodes.end,o=e&&(e.f&Ue)===0?e.nodes.start:a;i!==null;){var t=Bn(i);if(o.before(i),i===r)return;i=t}}function je(n,e,a){e===null?n.effect.first=a:e.next=a,a===null?n.effect.last=e:a.prev=e}function ae(n,e,a,i,r){pe&&ht();var o=e.$$slots?.[a],t=!1;o===!0&&(o=e.children,t=!0),o===void 0||o(n,t?()=>i:i)}function ls(n,e,a,i,r,o){let t=pe;pe&&ht();var l=null;pe&&Be.nodeType===Kn&&(l=Be,ht());var c=pe?Be:n,d=new as(c,!1);Qt(()=>{const g=e()||null;var u=Xn;if(g===null){d.ensure(null,null);return}return d.ensure(g,_=>{if(g){if(l=pe?l:document.createElementNS(u,g),Tn(l,l),i){pe&&Nn(g)&&l.append(document.createComment(""));var $=pe?tn(l):l.appendChild(ft());pe&&($===null?dt(!1):et($)),i(l,$)}Zn.nodes.end=l,_.before(l)}pe&&et(_)}),()=>{}},Yn),Qn(()=>{}),t&&(dt(!0),et(c))}const cs=1,gt=2,Nt=3,xt=4,ds=5,us=6;function vs(n){return{type:"auth",access_token:n}}function fs(){return{type:"supported_features",id:1,features:{coalesce_messages:1}}}function hs(){return{type:"get_states"}}function gs(n,e,a,i,r){const o={type:"call_service",domain:n,service:e,target:i,return_response:r};return a&&(o.service_data=a),o}function _s(n){const e={type:"subscribe_events"};return n&&(e.event_type=n),e}function Bt(n){return{type:"unsubscribe_events",subscription:n}}function ms(){return{type:"ping"}}function ps(n,e){return{type:"result",success:!1,error:{code:n,message:e}}}function ys(n){const e={},a=n.split("&");for(let i=0;i<a.length;i++){const r=a[i].split("="),o=decodeURIComponent(r[0]),t=r.length>1?decodeURIComponent(r[1]):void 0;e[o]=t}return e}const on=(n,e,a,i)=>{const[r,o,t]=n.split(".",3);return Number(r)>e||Number(r)===e&&(i===void 0?Number(o)>=a:Number(o)>a)||i!==void 0&&Number(r)===e&&Number(o)===a&&Number(t)>=i},bs="auth_invalid",$s="auth_ok";function ws(n){if(!n.auth)throw xt;const e=n.auth;let a=e.expired?e.refreshAccessToken().then(()=>{a=void 0},()=>{a=void 0}):void 0;const i=e.wsUrl;function r(o,t,l){const c=new WebSocket(i);let d=!1;const g=()=>{if(c.removeEventListener("close",g),d){l(gt);return}if(o===0){l(cs);return}const $=o===-1?-1:o-1;setTimeout(()=>r($,t,l),1e3)},u=async $=>{try{e.expired&&await(a||e.refreshAccessToken()),c.send(JSON.stringify(vs(e.accessToken)))}catch(w){d=w===gt,c.close()}},_=async $=>{const w=JSON.parse($.data);switch(w.type){case bs:d=!0,c.close();break;case $s:c.removeEventListener("open",u),c.removeEventListener("message",_),c.removeEventListener("close",g),c.removeEventListener("error",g),c.haVersion=w.ha_version,on(c.haVersion,2022,9)&&c.send(JSON.stringify(fs())),t(c);break}};c.addEventListener("open",u),c.addEventListener("message",_),c.addEventListener("close",g),c.addEventListener("error",g)}return new Promise((o,t)=>r(n.setupRetry,o,t))}class ks{constructor(e,a){this._handleMessage=i=>{let r=JSON.parse(i.data);Array.isArray(r)||(r=[r]),r.forEach(o=>{const t=this.commands.get(o.id);switch(o.type){case"event":t?t.callback(o.event):(console.warn(`Received event for unknown subscription ${o.id}. Unsubscribing.`),this.sendMessagePromise(Bt(o.id)).catch(l=>{}));break;case"result":t&&(o.success?(t.resolve(o.result),"subscribe"in t||this.commands.delete(o.id)):(t.reject(o.error),this.commands.delete(o.id)));break;case"pong":t?(t.resolve(),this.commands.delete(o.id)):console.warn(`Received unknown pong response ${o.id}`);break}})},this._handleClose=async()=>{const i=this.commands;if(this.commandId=1,this.oldSubscriptions=this.commands,this.commands=new Map,this.socket=void 0,i.forEach(t=>{"subscribe"in t||t.reject(ps(Nt,"Connection lost"))}),this.closeRequested)return;this.fireEvent("disconnected");const r=Object.assign(Object.assign({},this.options),{setupRetry:0}),o=t=>{setTimeout(async()=>{if(!this.closeRequested)try{const l=await r.createSocket(r);this._setSocket(l)}catch(l){if(this._queuedMessages){const c=this._queuedMessages;this._queuedMessages=void 0;for(const d of c)d.reject&&d.reject(Nt)}l===gt?this.fireEvent("reconnect-error",l):o(t+1)}},Math.min(t,5)*1e3)};this.suspendReconnectPromise&&(await this.suspendReconnectPromise,this.suspendReconnectPromise=void 0,this._queuedMessages=[]),o(0)},this.options=a,this.commandId=2,this.commands=new Map,this.eventListeners=new Map,this.closeRequested=!1,this._setSocket(e)}get connected(){return this.socket!==void 0&&this.socket.readyState==this.socket.OPEN}_setSocket(e){this.socket=e,this.haVersion=e.haVersion,e.addEventListener("message",this._handleMessage),e.addEventListener("close",this._handleClose);const a=this.oldSubscriptions;a&&(this.oldSubscriptions=void 0,a.forEach(r=>{"subscribe"in r&&r.subscribe&&r.subscribe().then(o=>{r.unsubscribe=o,r.resolve()})}));const i=this._queuedMessages;if(i){this._queuedMessages=void 0;for(const r of i)r.resolve()}this.fireEvent("ready")}addEventListener(e,a){let i=this.eventListeners.get(e);i||(i=[],this.eventListeners.set(e,i)),i.push(a)}removeEventListener(e,a){const i=this.eventListeners.get(e);if(!i)return;const r=i.indexOf(a);r!==-1&&i.splice(r,1)}fireEvent(e,a){(this.eventListeners.get(e)||[]).forEach(i=>i(this,a))}suspendReconnectUntil(e){this.suspendReconnectPromise=e}suspend(){if(!this.suspendReconnectPromise)throw new Error("Suspend promise not set");this.socket&&this.socket.close()}reconnect(e=!1){if(this.socket){if(!e){this.socket.close();return}this.socket.removeEventListener("message",this._handleMessage),this.socket.removeEventListener("close",this._handleClose),this.socket.close(),this._handleClose()}}close(){this.closeRequested=!0,this.socket&&this.socket.close()}async subscribeEvents(e,a){return this.subscribeMessage(e,_s(a))}ping(){return this.sendMessagePromise(ms())}sendMessage(e,a){if(!this.connected)throw Nt;if(this._queuedMessages){if(a)throw new Error("Cannot queue with commandId");this._queuedMessages.push({resolve:()=>this.sendMessage(e)});return}a||(a=this._genCmdId()),e.id=a,this.socket.send(JSON.stringify(e))}sendMessagePromise(e){return new Promise((a,i)=>{if(this._queuedMessages){this._queuedMessages.push({reject:i,resolve:async()=>{try{a(await this.sendMessagePromise(e))}catch(o){i(o)}}});return}const r=this._genCmdId();this.commands.set(r,{resolve:a,reject:i}),this.sendMessage(e,r)})}async subscribeMessage(e,a,i){if(this._queuedMessages&&await new Promise((o,t)=>{this._queuedMessages.push({resolve:o,reject:t})}),i?.preCheck&&!await i.preCheck())throw new Error("Pre-check failed");let r;return await new Promise((o,t)=>{const l=this._genCmdId();r={resolve:o,reject:t,callback:e,subscribe:i?.resubscribe!==!1?()=>this.subscribeMessage(e,a,i):void 0,unsubscribe:async()=>{this.connected&&await this.sendMessagePromise(Bt(l)),this.commands.delete(l)}},this.commands.set(l,r);try{this.sendMessage(a,l)}catch{}}),()=>r.unsubscribe()}_genCmdId(){return++this.commandId}}const Is=()=>`${location.protocol}//${location.host}/`,Es=n=>n*1e3+Date.now();function Ss(){const{protocol:n,host:e,pathname:a,search:i}=location;return`${n}//${e}${a}${i}`}function Ms(n,e,a,i){let r=`${n}/auth/authorize?response_type=code&redirect_uri=${encodeURIComponent(a)}`;return e!==null&&(r+=`&client_id=${encodeURIComponent(e)}`),i&&(r+=`&state=${encodeURIComponent(i)}`),r}function Ts(n,e,a,i){a+=(a.includes("?")?"&":"?")+"auth_callback=1",document.location.href=Ms(n,e,a,i)}async function ln(n,e,a){const i=typeof location<"u"&&location;if(i&&i.protocol==="https:"){const l=document.createElement("a");if(l.href=n,l.protocol==="http:"&&l.hostname!=="localhost")throw ds}const r=new FormData;e!==null&&r.append("client_id",e),Object.keys(a).forEach(l=>{r.append(l,a[l])});const o=await fetch(`${n}/auth/token`,{method:"POST",credentials:"same-origin",body:r});if(!o.ok)throw o.status===400||o.status===403?gt:new Error("Unable to fetch tokens");const t=await o.json();return t.hassUrl=n,t.clientId=e,t.expires=Es(t.expires_in),t}function Jt(n,e,a){return ln(n,e,{code:a,grant_type:"authorization_code"})}function Ns(n){return btoa(JSON.stringify(n))}function Cs(n){return JSON.parse(atob(n))}class Os{constructor(e,a){this.data=e,this._saveTokens=a}get wsUrl(){return`ws${this.data.hassUrl.substr(4)}/api/websocket`}get accessToken(){return this.data.access_token}get expired(){return Date.now()>this.data.expires}async refreshAccessToken(){if(!this.data.refresh_token)throw new Error("No refresh_token");const e=await ln(this.data.hassUrl,this.data.clientId,{grant_type:"refresh_token",refresh_token:this.data.refresh_token});e.refresh_token=this.data.refresh_token,this.data=e,this._saveTokens&&this._saveTokens(e)}async revoke(){if(!this.data.refresh_token)throw new Error("No refresh_token to revoke");const e=new FormData;e.append("token",this.data.refresh_token),await fetch(`${this.data.hassUrl}/auth/revoke`,{method:"POST",credentials:"same-origin",body:e}),this._saveTokens&&this._saveTokens(null)}}async function As(n={}){let e,a=n.hassUrl;a&&a[a.length-1]==="/"&&(a=a.substr(0,a.length-1));const i=n.clientId!==void 0?n.clientId:Is(),r=n.limitHassInstance===!0;if(n.authCode&&a&&(e=await Jt(a,i,n.authCode),n.saveTokens&&n.saveTokens(e)),!e){const o=ys(location.search.substr(1));if("auth_callback"in o){const t=Cs(o.state);if(r&&(t.hassUrl!==a||t.clientId!==i))throw us;e=await Jt(t.hassUrl,t.clientId,o.code),n.saveTokens&&n.saveTokens(e)}}if(!e&&n.loadTokens&&(e=await n.loadTokens()),e&&(a===void 0||e.hassUrl===a))return new Os(e,n.saveTokens);if(a===void 0)throw xt;return Ts(a,i,n.redirectUrl||Ss(),Ns({hassUrl:a,clientId:i})),new Promise(()=>{})}const xs=n=>{let e=[];function a(r){let o=[];for(let t=0;t<e.length;t++)e[t]===r?r=null:o.push(e[t]);e=o}function i(r,o){n=o?r:Object.assign(Object.assign({},n),r);let t=e;for(let l=0;l<t.length;l++)t[l](n)}return{get state(){return n},action(r){function o(t){i(t,!1)}return function(){let t=[n];for(let c=0;c<arguments.length;c++)t.push(arguments[c]);let l=r.apply(this,t);if(l!=null)return l instanceof Promise?l.then(o):o(l)}},setState:i,clearState(){n=void 0},subscribe(r){return e.push(r),()=>{a(r)}}}},Ds=5e3,Gt=(n,e,a,i,r={unsubGrace:!0})=>{if(n[e])return n[e];let o=0,t,l,c=xs();const d=()=>{if(!a)throw new Error("Collection does not support refresh");return a(n).then(I=>c.setState(I,!0))},g=()=>d().catch(I=>{if(n.connected)throw I}),u=()=>{if(l!==void 0){clearTimeout(l),l=void 0;return}i&&(t=i(n,c)),a&&(n.addEventListener("ready",g),g()),n.addEventListener("disconnected",w)},_=()=>{l=void 0,t&&t.then(I=>{I()}),c.clearState(),n.removeEventListener("ready",d),n.removeEventListener("disconnected",w)},$=()=>{l=setTimeout(_,Ds)},w=()=>{l&&(clearTimeout(l),_())};return n[e]={get state(){return c.state},refresh:d,subscribe(I){o++,o===1&&u();const h=c.subscribe(I);return c.state!==void 0&&setTimeout(()=>I(c.state),0),()=>{h(),o--,o||(r.unsubGrace?$():_())}}},n[e]},Ps=n=>n.sendMessagePromise(hs()),Le=(n,e,a,i,r,o)=>n.sendMessagePromise(gs(e,a,i,r,o));function Us(n,e){const a=Object.assign({},n.state);if(e.a)for(const i in e.a){const r=e.a[i];let o=new Date(r.lc*1e3).toISOString();a[i]={entity_id:i,state:r.s,attributes:r.a,context:typeof r.c=="string"?{id:r.c,parent_id:null,user_id:null}:r.c,last_changed:o,last_updated:r.lu?new Date(r.lu*1e3).toISOString():o}}if(e.r)for(const i of e.r)delete a[i];if(e.c)for(const i in e.c){let r=a[i];if(!r){console.warn("Received state update for unknown entity",i);continue}r=Object.assign({},r);const{"+":o,"-":t}=e.c[i],l=o?.a||t?.a,c=l?Object.assign({},r.attributes):r.attributes;if(o&&(o.s!==void 0&&(r.state=o.s),o.c&&(typeof o.c=="string"?r.context=Object.assign(Object.assign({},r.context),{id:o.c}):r.context=Object.assign(Object.assign({},r.context),o.c)),o.lc?r.last_updated=r.last_changed=new Date(o.lc*1e3).toISOString():o.lu&&(r.last_updated=new Date(o.lu*1e3).toISOString()),o.a&&Object.assign(c,o.a)),t?.a)for(const d of t.a)delete c[d];l&&(r.attributes=c),a[i]=r}n.setState(a,!0)}const Ls=(n,e)=>n.subscribeMessage(a=>Us(e,a),{type:"subscribe_entities"});function zs(n,e){const a=n.state;if(a===void 0)return;const{entity_id:i,new_state:r}=e.data;if(r)n.setState({[r.entity_id]:r});else{const o=Object.assign({},a);delete o[i],n.setState(o,!0)}}async function Rs(n){const e=await Ps(n),a={};for(let i=0;i<e.length;i++){const r=e[i];a[r.entity_id]=r}return a}const Hs=(n,e)=>n.subscribeEvents(a=>zs(e,a),"state_changed"),js=n=>on(n.haVersion,2022,4,0)?Gt(n,"_ent",void 0,Ls):Gt(n,"_ent",Rs,Hs),Fs=(n,e)=>js(n).subscribe(e);async function qs(n){const e=Object.assign({setupRetry:0,createSocket:ws},n),a=await e.createSocket(e);return new ks(a,e)}const Me=yt({}),Oe=yt(null),Qe=yt(!1),Ve=yt(null);let Pe;function cn(){if(typeof window<"u")try{const n=window.location.origin;if(window.parent!==window)try{const e=window.parent.location.origin;if(e.includes(":8123")||e.includes("home-assistant")||e.includes("homeassistant"))return e}catch{if(n.includes(":8123")||n.includes("home-assistant")||n.includes("homeassistant"))return n}if(n.includes(":8123")||n.includes("home-assistant")||n.includes("homeassistant")||window.location.hostname.includes("homeassistant")||window.location.hostname.includes("home-assistant")||window.location.pathname.includes("/hacsfiles/")||window.location.pathname.includes("/local/"))return n}catch(n){console.error("Error detecting HA URL:",n)}if(typeof window<"u"){const n=localStorage.getItem("hassUrl");if(n)return n}return"http://homeassistant.local:8123"}function dn(n){if(!n)return null;try{const e=cn();return new URL(n,e).href}catch(e){return console.error("Error building entity picture URL:",e),null}}async function Vs(){if(typeof window<"u"){const n=localStorage.getItem("hassTokens");if(n)try{const e=JSON.parse(n);if(e.expires&&e.expires>Date.now())return e}catch{}}return null}async function Bs(n){typeof window<"u"&&(localStorage.setItem("hassTokens",JSON.stringify(n)),localStorage.setItem("hassUrl",n.hassUrl))}async function Js(){try{const n=cn();console.log("Connecting to Home Assistant at:",n);const e=await As({hassUrl:n,loadTokens:Vs,saveTokens:Bs});console.log("Authentication successful, creating connection..."),Pe=await qs({auth:e}),console.log("Connection established via createConnection"),Qe.set(!0),Oe.set(Pe),Ve.set(null),Fs(Pe,a=>{console.log("Received entity updates",Object.keys(a).length),Me.set(a)}),Pe.addEventListener("ready",()=>{console.log("Connection ready event"),Qe.set(!0),Oe.set(Pe),Ve.set(null)}),Pe.addEventListener("disconnected",()=>{console.log("Disconnected from Home Assistant"),Qe.set(!1),Oe.set(null),Ve.set("Disconnected")}),Pe.addEventListener("reconnect-error",()=>{console.error("Reconnect error"),Ve.set("Reconnecting...")})}catch(n){console.error("Connection failed",n),Qe.set(!1),n===xt?Ve.set("Host required"):Ve.set(n.message||"Connection failed - Check console")}}async function Gs(n,e,a){const i=e||new Date,r=a||new Date(Date.now()+10080*60*1e3);if(console.log("Fetching calendar events:",{entityId:n,start:i.toISOString(),end:r.toISOString(),startDate:i.toLocaleString(),endDate:r.toLocaleString()}),Pe)try{let o=function(d,g=""){if(!d)return null;if(Array.isArray(d)){if(d.length===0)return null;const u=d[0];return u&&typeof u=="object"&&(u.summary||u.start||u.end||u.title)?(console.log(`Found event array at path: ${g} with ${d.length} events`),d):null}if(typeof d=="object"){for(const u in d)if(d.hasOwnProperty(u)){const _=o(d[u],g?`${g}.${u}`:u);if(_)return _}}return null};const t=await Pe.sendMessagePromise({type:"call_service",domain:"calendar",service:"get_events",service_data:{entity_id:n,start_date_time:i.toISOString(),end_date_time:r.toISOString()},return_response:!0});console.log("Calendar service result:",JSON.stringify(t,null,2)),console.log("Result type:",typeof t),console.log("Is array:",Array.isArray(t)),console.log("Entity ID:",n);const l=o(t);if(l)return console.log(`Found ${l.length} events recursively`),l;let c=null;if(t?.response){const d=t.response;if(console.log("Found result.response:",typeof d,Array.isArray(d)),Array.isArray(d))c=d,console.log("Response is array with",c.length,"events");else if(d&&typeof d=="object")if(d[n]&&Array.isArray(d[n]))c=d[n],console.log(`Found events in response.${n}:`,c.length,"events");else if(d.events&&Array.isArray(d.events))c=d.events,console.log("Found events in response.events:",c.length,"events");else{const g=Object.keys(d);console.log("Response keys:",g);for(const u of g)if(Array.isArray(d[u])&&d[u].length>0){const _=d[u][0];if(_&&typeof _=="object"&&(_.summary||_.start||_.end||_.title)){c=d[u],console.log(`Found event array in response.${u}:`,c.length,"events");break}}}}else if(Array.isArray(t)&&t.length>0){const d=t[0];d&&typeof d=="object"&&(d.summary||d.start||d.end||d.title)&&(c=t,console.log("Result is directly an array:",c.length,"events"))}else t?.events&&Array.isArray(t.events)?(c=t.events,console.log("Found events in result.events:",c.length,"events")):t&&typeof t=="object"&&t[n]&&Array.isArray(t[n])&&(c=t[n],console.log(`Found events in result.${n}:`,c.length,"events"));return Array.isArray(c)&&c.length>0?(console.log(`Returning ${c.length} events`),c[0]&&console.log("First event structure:",Object.keys(c[0])),c):(console.log("No events found in result structure"),console.log("Result keys:",t?Object.keys(t):"null"),t?.response&&typeof t.response=="object"&&console.log("Response keys:",Object.keys(t.response)),[])}catch(o){throw console.error("Service call failed:",o),new Error(`Calendar service error: ${o.message||o.code||"Unknown error"}`)}throw new Error("Not connected to Home Assistant. Calendar events require a websocket connection.")}const Ws={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var Ks=Cn("<svg><!><!></svg>");function ie(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]),i=ne(a,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);we(e,!1);let r=z(e,"name",8,void 0),o=z(e,"color",8,"currentColor"),t=z(e,"size",8,24),l=z(e,"strokeWidth",8,2),c=z(e,"absoluteStrokeWidth",8,!1),d=z(e,"iconNode",24,()=>[]);const g=(...w)=>w.filter((I,h,b)=>!!I&&b.indexOf(I)===h).join(" ");Se();var u=Ks();qt(u,(w,I)=>({...Ws,...i,width:t(),height:t(),stroke:o(),"stroke-width":w,class:I}),[()=>(A(c()),A(l()),A(t()),B(()=>c()?Number(l())*24/Number(t()):l())),()=>(A(r()),A(a),B(()=>g("lucide-icon","lucide",r()?`lucide-${r()}`:"",a.class)))]);var _=f(u);nt(_,1,d,tt,(w,I)=>{var h=me(()=>an(s(I),2));let b=()=>s(h)[0],V=()=>s(h)[1];var te=j(),q=O(te);ls(q,b,!0,(se,oe)=>{qt(se,()=>({...V()}))}),p(w,te)});var $=E(_);ae($,e,"default",{}),v(u),p(n,u),ke()}function _t(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}],["path",{d:"M10 4v4"}],["path",{d:"M2 8h20"}],["path",{d:"M6 4v4"}]];ie(n,re({name:"app-window"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function Ys(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M 22 14 L 22 10"}],["rect",{x:"2",y:"6",width:"16",height:"12",rx:"2"}]];ie(n,re({name:"battery"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function Wt(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M8 2v4"}],["path",{d:"M16 2v4"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2"}],["path",{d:"M3 10h18"}]];ie(n,re({name:"calendar"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function mt(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m9 12 2 2 4-4"}]];ie(n,re({name:"circle-check"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function Xs(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}],["path",{d:"M12 17h.01"}]];ie(n,re({name:"circle-question-mark"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function Kt(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M12 6v6l4 2"}],["circle",{cx:"12",cy:"12",r:"10"}]];ie(n,re({name:"clock"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function un(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M10 12h.01"}],["path",{d:"M18 20V6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14"}],["path",{d:"M2 20h20"}]];ie(n,re({name:"door-closed"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function vn(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M11 20H2"}],["path",{d:"M11 4.562v16.157a1 1 0 0 0 1.242.97L19 20V5.562a2 2 0 0 0-1.515-1.94l-4-1A2 2 0 0 0 11 4.561z"}],["path",{d:"M11 4H8a2 2 0 0 0-2 2v14"}],["path",{d:"M14 12h.01"}],["path",{d:"M22 20h-3"}]];ie(n,re({name:"door-open"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function fn(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z"}],["path",{d:"M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z"}],["path",{d:"M16 17h4"}],["path",{d:"M4 13h4"}]];ie(n,re({name:"footprints"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function Zs(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}]];ie(n,re({name:"house"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function hn(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M16.8 11.2c.8-.9 1.2-2 1.2-3.2a6 6 0 0 0-9.3-5"}],["path",{d:"m2 2 20 20"}],["path",{d:"M6.3 6.3a4.67 4.67 0 0 0 1.2 5.2c.7.7 1.3 1.5 1.5 2.5"}],["path",{d:"M9 18h6"}],["path",{d:"M10 22h4"}]];ie(n,re({name:"lightbulb-off"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function Qs(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"}],["path",{d:"M9 18h6"}],["path",{d:"M10 22h4"}]];ie(n,re({name:"lightbulb"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function ea(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"}],["circle",{cx:"12",cy:"10",r:"3"}]];ie(n,re({name:"map-pin"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function ta(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401"}]];ie(n,re({name:"moon"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function Yt(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1"}]];ie(n,re({name:"pause"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function Xt(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"}]];ie(n,re({name:"play"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function na(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M12 22v-5"}],["path",{d:"M15 8V2"}],["path",{d:"M17 8a1 1 0 0 1 1 1v4a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1z"}],["path",{d:"M9 8V2"}]];ie(n,re({name:"plug"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function Dt(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M12 2v10"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04"}]];ie(n,re({name:"power"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function sa(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z"}],["path",{d:"M3 20V4"}]];ie(n,re({name:"skip-back"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function aa(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M21 4v16"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z"}]];ie(n,re({name:"skip-forward"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function ra(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["circle",{cx:"12",cy:"12",r:"4"}],["path",{d:"M12 2v2"}],["path",{d:"M12 20v2"}],["path",{d:"m4.93 4.93 1.41 1.41"}],["path",{d:"m17.66 17.66 1.41 1.41"}],["path",{d:"M2 12h2"}],["path",{d:"M20 12h2"}],["path",{d:"m6.34 17.66-1.41 1.41"}],["path",{d:"m19.07 4.93-1.41 1.41"}]];ie(n,re({name:"sun"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function ia(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M3.5 21 14 3"}],["path",{d:"M20.5 21 10 3"}],["path",{d:"M15.5 21 12 15l-3.5 6"}],["path",{d:"M2 21h20"}]];ie(n,re({name:"tent"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function oa(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"}]];ie(n,re({name:"thermometer"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function gn(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["path",{d:"M12 9v4"}],["path",{d:"M12 17h.01"}]];ie(n,re({name:"triangle-alert"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function la(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"m17 2-5 5-5-5"}],["rect",{width:"20",height:"15",x:"2",y:"7",rx:"2"}]];ie(n,re({name:"tv"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}function pt(n,e){const a=ne(e,["children","$$slots","$$events","$$legacy"]);const i=[["path",{d:"M18 21V10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v11"}],["path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 1.132-1.803l7.95-3.974a2 2 0 0 1 1.837 0l7.948 3.974A2 2 0 0 1 22 8z"}],["path",{d:"M6 13h12"}],["path",{d:"M6 17h12"}]];ie(n,re({name:"warehouse"},()=>a,{get iconNode(){return i},children:(r,o)=>{var t=j(),l=O(t);ae(l,e,"default",{}),p(r,t)},$$slots:{default:!0}}))}var ca=U('<div><div class="icon svelte-1ds1j5k"><!></div> <div class="name svelte-1ds1j5k"> </div> <div class="state svelte-1ds1j5k"> </div></div>');function da(n,e){we(e,!1);const a=()=>fe(Me,"$entities",r),i=()=>fe(Oe,"$connection",r),[r,o]=Ee(),t=C(),l=C();let c=z(e,"entityId",8),d=z(e,"label",8);function g(){i()&&Le(i(),"homeassistant","toggle",{entity_id:c()})}H(()=>(a(),A(c())),()=>{N(t,a()[c()])}),H(()=>s(t),()=>{N(l,s(t)?.state==="on")}),xe(),Se();var u=ca(),_=f(u),$=f(_);{var w=q=>{Qs(q,{size:32})},I=q=>{hn(q,{size:32})};J($,q=>{s(l)?q(w):q(I,!1)})}v(_);var h=E(_,2),b=f(h,!0);v(h);var V=E(h,2),te=f(V,!0);v(V),v(u),Q(()=>{Ae(u,1,`tile ${s(l)?"on":"off"} glass-panel`,"svelte-1ds1j5k"),P(b,(A(d()),s(t),A(c()),B(()=>d()||s(t)?.attributes.friendly_name||c()))),P(te,(s(t),B(()=>s(t)?.state||"Unknown")))}),Fe("click",u,g),p(n,u),ke(),o()}var ua=U('<div class="tile sensor glass-panel svelte-1mck596"><div class="header svelte-1mck596"> </div> <div class="value svelte-1mck596"> <span class="unit svelte-1mck596"> </span></div></div>');function va(n,e){we(e,!1);const a=()=>fe(Me,"$entities",i),[i,r]=Ee(),o=C(),t=C(),l=C(),c=C();let d=z(e,"entityId",8),g=z(e,"label",8),u=z(e,"format",8,""),_=z(e,"unit",8,"");H(()=>(a(),A(d())),()=>{N(o,a()[d()])}),H(()=>s(o),()=>{N(t,s(o)?.state)}),H(()=>(A(_()),s(o)),()=>{N(l,_()||s(o)?.attributes.unit_of_measurement||"")}),H(()=>(A(u()),s(t)),()=>{N(c,u()==="date"&&s(t)?new Date(s(t)).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):s(t))}),xe(),Se();var $=ua(),w=f($),I=f(w,!0);v(w);var h=E(w,2),b=f(h),V=E(b),te=f(V,!0);v(V),v(h),v($),Q(()=>{P(I,(A(g()),s(o),A(d()),B(()=>g()||s(o)?.attributes.friendly_name||d()))),P(b,`${(s(c)||"--")??""} `),P(te,s(l))}),p(n,$),ke(),r()}var fa=U('<div><div class="header svelte-d2lh25"> </div> <div class="content svelte-d2lh25"><span class="icon svelte-d2lh25"><!></span> <span class="state svelte-d2lh25"> </span></div></div>');function ha(n,e){we(e,!1);const a=()=>fe(Me,"$entities",i),[i,r]=Ee(),o=C(),t=C(),l=C(),c=C(),d=C();let g=z(e,"entityId",8),u=z(e,"label",8),_=z(e,"deviceClass",8,"door");function $(ee){switch(ee){case"door":return"Open";case"window":return"Open";case"motion":return"Detected";case"garage":return"Open";case"problem":return"Problem";default:return"On"}}function w(ee){switch(ee){case"door":return"Closed";case"window":return"Closed";case"motion":return"Clear";case"garage":return"Closed";case"problem":return"OK";default:return"Off"}}function I(ee){switch(ee){case"door":return vn;case"window":return _t;case"motion":return fn;case"garage":return pt;default:return gn}}function h(ee){switch(ee){case"door":return un;case"window":return _t;case"motion":return mt;case"garage":return pt;default:return mt}}H(()=>(a(),A(g())),()=>{N(o,a()[g()])}),H(()=>s(o),()=>{N(t,s(o)?.state)}),H(()=>s(t),()=>{N(l,s(t)==="on")}),H(()=>(s(l),A(_())),()=>{N(c,s(l)?$(_()):w(_()))}),H(()=>(s(l),A(_())),()=>{N(d,s(l)?I(_()):h(_()))}),xe(),Se();var b=fa(),V=f(b),te=f(V,!0);v(V);var q=E(V,2),se=f(q),oe=f(se);rn(oe,()=>s(d),(ee,X)=>{X(ee,{size:24})}),v(se);var Y=E(se,2),ce=f(Y,!0);v(Y),v(q),v(b),Q(()=>{Ae(b,1,`tile ${s(l)?"active":"inactive"} glass-panel`,"svelte-d2lh25"),P(te,(A(u()),s(o),A(g()),B(()=>u()||s(o)?.attributes.friendly_name||g()))),P(ce,s(c))}),p(n,b),ke(),r()}var ga=U('<div><div class="icon svelte-h88ioc"><!></div> <div class="name svelte-h88ioc"> </div> <div class="state svelte-h88ioc"> </div></div>');function _a(n,e){we(e,!1);const a=()=>fe(Me,"$entities",r),i=()=>fe(Oe,"$connection",r),[r,o]=Ee(),t=C(),l=C();let c=z(e,"entityId",8),d=z(e,"label",8);function g(){i()&&Le(i(),"homeassistant","toggle",{entity_id:c()})}H(()=>(a(),A(c())),()=>{N(t,a()[c()])}),H(()=>s(t),()=>{N(l,s(t)?.state==="on")}),xe(),Se();var u=ga(),_=f(u),$=f(_);na($,{size:32}),v(_);var w=E(_,2),I=f(w,!0);v(w);var h=E(w,2),b=f(h,!0);v(h),v(u),Q(()=>{Ae(u,1,`tile ${s(l)?"on":"off"} glass-panel`,"svelte-h88ioc"),P(I,(A(d()),s(t),A(c()),B(()=>d()||s(t)?.attributes.friendly_name||c()))),P(b,(s(t),B(()=>s(t)?.state||"Unknown")))}),Fe("click",u,g),p(n,u),ke(),o()}var ma=U('<img class="avatar svelte-1kgjbrn"/>'),pa=U('<span class="icon svelte-1kgjbrn"><!></span>'),ya=U('<div class="battery svelte-1kgjbrn"><span><!></span> <span> </span></div>'),ba=U('<div><div class="icon-area svelte-1kgjbrn"><!></div> <div class="info svelte-1kgjbrn"><div class="name svelte-1kgjbrn"> </div> <div class="state svelte-1kgjbrn"> </div> <!></div></div>');function $a(n,e){we(e,!1);const a=()=>fe(Me,"$entities",i),[i,r]=Ee(),o=C(),t=C(),l=C(),c=C(),d=C(),g=C(),u=C(),_=C();let $=z(e,"entityId",8),w=z(e,"label",8),I=z(e,"batteryEntityId",8,void 0);H(()=>(a(),A($())),()=>{N(o,a()[$()])}),H(()=>s(o),()=>{N(t,s(o)?.state)}),H(()=>s(t),()=>{N(l,s(t)==="home")}),H(()=>s(o),()=>{N(c,s(o)?.attributes.entity_picture)}),H(()=>s(c),()=>{N(d,dn(s(c)))}),H(()=>(A(I()),a()),()=>{N(g,I()?a()[I()]:null)}),H(()=>s(g),()=>{N(u,(()=>{if(!s(g)||!s(g).state||s(g).state==="unavailable"||s(g).state==="unknown")return null;const k=parseFloat(s(g).state);return isNaN(k)?null:k})())}),H(()=>s(g),()=>{N(_,s(g)?.attributes.unit_of_measurement||"%")}),H(()=>(A(I()),s(g),a(),s(u),s(_)),()=>{I()&&(s(g)?console.log(`Battery entity ${I()}:`,{state:s(g).state,level:s(u),unit:s(_)}):console.warn(`Battery entity "${I()}" not found in entities. Available entities:`,Object.keys(a()).filter(k=>k.includes("battery")||k.includes("phone"))))}),xe(),Se();var h=ba(),b=f(h),V=f(b);{var te=k=>{var m=ma();Q(()=>{ut(m,"src",s(d)),ut(m,"alt",w())}),p(k,m)},q=k=>{var m=pa(),y=f(m);{var M=L=>{Zs(L,{size:24})},x=L=>{ia(L,{size:24})};J(y,L=>{s(l)?L(M):L(x,!1)})}v(m),p(k,m)};J(V,k=>{s(d)?k(te):k(q,!1)})}v(b);var se=E(b,2),oe=f(se),Y=f(oe,!0);v(oe);var ce=E(oe,2),ee=f(ce,!0);v(ce);var X=E(ce,2);{var S=k=>{var m=ya(),y=f(m);let M;var x=f(y);Ys(x,{size:14}),v(y);var L=E(y,2),F=f(L);v(L),v(m),Q(K=>{M=Ae(y,1,"battery-icon svelte-1kgjbrn",null,M,{low:s(u)<20}),P(F,`${K??""}${s(_)??""}`)},[()=>(s(u),B(()=>Math.round(s(u))))]),p(k,m)};J(X,k=>{s(u)!==null&&k(S)})}v(se),v(h),Q(()=>{Ae(h,1,`tile ${s(l)?"home":"away"} glass-panel`,"svelte-1kgjbrn"),P(Y,(A(w()),s(o),A($()),B(()=>w()||s(o)?.attributes.friendly_name||$()))),P(ee,s(t)||"Unknown")}),p(n,h),ke(),r()}var wa=U('<div class="artist svelte-l11nk0"> </div>'),ka=U('<div class="temperature svelte-l11nk0"><!> </div>'),Ia=U('<div><div class="bg-overlay svelte-l11nk0"></div> <div class="content svelte-l11nk0"><div class="header svelte-l11nk0"><div class="header-left svelte-l11nk0"><span class="icon"><!></span> <span class="label"> </span></div> <div class="header-right svelte-l11nk0"><button class="btn-icon power svelte-l11nk0"><!></button></div></div> <div class="info svelte-l11nk0"><div class="text-info"><div class="title svelte-l11nk0"> </div> <!></div> <div class="controls svelte-l11nk0"><!> <button class="btn-control svelte-l11nk0"><!></button> <button class="btn-control play-pause svelte-l11nk0"><!></button> <button class="btn-control svelte-l11nk0"><!></button></div></div></div></div>');function Ea(n,e){we(e,!1);const a=()=>fe(Me,"$entities",r),i=()=>fe(Oe,"$connection",r),[r,o]=Ee(),t=C(),l=C(),c=C(),d=C(),g=C(),u=C(),_=C(),$=C(),w=C(),I=C();let h=z(e,"entityId",8),b=z(e,"label",8),V=z(e,"temperatureEntityId",8,void 0);function te(W){W.stopPropagation(),i()&&Le(i(),"media_player","media_play_pause",{entity_id:h()})}function q(W){W.stopPropagation(),i()&&Le(i(),"media_player","media_next_track",{entity_id:h()})}function se(W){W.stopPropagation(),i()&&Le(i(),"media_player","media_previous_track",{entity_id:h()})}function oe(W){W.stopPropagation(),i()&&Le(i(),"media_player","toggle",{entity_id:h()})}H(()=>(a(),A(h())),()=>{N(t,a()[h()])}),H(()=>s(t),()=>{N(l,s(t)?.state)}),H(()=>s(l),()=>{N(c,s(l)==="playing")}),H(()=>s(t),()=>{N(d,s(t)?.attributes||{})}),H(()=>s(d),()=>{N(g,s(d).media_title||s(d).source||"No Media")}),H(()=>s(d),()=>{N(u,s(d).media_artist||s(d).media_series_title||"")}),H(()=>s(d),()=>{N(_,s(d).entity_picture)}),H(()=>s(_),()=>{N($,dn(s(_)))}),H(()=>(A(V()),a()),()=>{N(w,V()?a()[V()]:null)}),H(()=>s(w),()=>{N(I,s(w)?`${s(w).state}${s(w).attributes.unit_of_measurement||"°C"}`:null)}),xe(),Se();var Y=Ia();let ce;var ee=E(f(Y),2),X=f(ee),S=f(X),k=f(S),m=f(k);{var y=W=>{Xt(W,{size:16,fill:"currentColor"})},M=W=>{var be=j(),ue=O(be);{var ge=he=>{Yt(he,{size:16,fill:"currentColor"})},_e=he=>{la(he,{size:16})};J(ue,he=>{s(l)==="paused"?he(ge):he(_e,!1)},!0)}p(W,be)};J(m,W=>{s(l)==="playing"?W(y):W(M,!1)})}v(k);var x=E(k,2),L=f(x,!0);v(x),v(S);var F=E(S,2),K=f(F),le=f(K);Dt(le,{size:20}),v(K),v(F),v(X);var ye=E(X,2),G=f(ye),D=f(G),Z=f(D,!0);v(D);var de=E(D,2);{var R=W=>{var be=wa(),ue=f(be,!0);v(be),Q(()=>P(ue,s(u))),p(W,be)};J(de,W=>{s(u)&&W(R)})}v(G);var ve=E(G,2),$e=f(ve);{var qe=W=>{var be=ka(),ue=f(be);oa(ue,{size:14,class:"temp-icon"});var ge=E(ue);v(be),Q(()=>P(ge,` ${s(I)??""}`)),p(W,be)};J($e,W=>{s(I)&&W(qe)})}var Te=E($e,2),Je=f(Te);sa(Je,{size:24,fill:"currentColor"}),v(Te);var T=E(Te,2),Ge=f(T);{var st=W=>{Yt(W,{size:32,fill:"currentColor"})},at=W=>{Xt(W,{size:32,fill:"currentColor"})};J(Ge,W=>{s(c)?W(st):W(at,!1)})}v(T);var De=E(T,2),Ne=f(De);aa(Ne,{size:24,fill:"currentColor"}),v(De),v(ve),v(ye),v(ee),v(Y),Q(()=>{Ae(Y,1,`tile ${s(l)??""} glass-panel`,"svelte-l11nk0"),ce=ns(Y,"",ce,{"--bg-image":s($)?`url('${s($)}')`:"none"}),P(L,(A(b()),s(d),B(()=>b()||s(d).friendly_name||"Media"))),P(Z,s(g))}),Fe("click",K,oe),Fe("click",Te,se),Fe("click",T,te),Fe("click",De,q),p(n,Y),ke(),o()}var Sa=U('<div><div class="icon svelte-1kbr3j6"><!></div> <div class="name svelte-1kbr3j6"> </div> <div class="state svelte-1kbr3j6"> </div></div>');function Ma(n,e){we(e,!1);const a=()=>fe(Me,"$entities",r),i=()=>fe(Oe,"$connection",r),[r,o]=Ee(),t=C(),l=C();let c=z(e,"entityId",8),d=z(e,"label",8,"");function g(){i()&&Le(i(),"input_boolean","toggle",{entity_id:c()})}H(()=>(a(),A(c())),()=>{N(t,a()[c()])}),H(()=>s(t),()=>{N(l,s(t)?.state==="on")}),xe(),Se();var u=Sa(),_=f(u),$=f(_);Dt($,{size:32}),v(_);var w=E(_,2),I=f(w,!0);v(w);var h=E(w,2),b=f(h,!0);v(h),v(u),Q(()=>{Ae(u,1,ss(s(l)?"tile on glass-panel":"tile off glass-panel"),"svelte-1kbr3j6"),P(I,(A(d()),s(t),A(c()),B(()=>d()||s(t)?.attributes.friendly_name||c()))),P(b,(s(t),B(()=>s(t)?.state||"Unknown")))}),Fe("click",u,g),p(n,u),ke(),o()}var Ta=U('<div><div class="icon svelte-tiial9"><!></div> <div class="name svelte-tiial9"> </div> <div class="state svelte-tiial9"> </div></div>');function Na(n,e){we(e,!1);const a=()=>fe(Me,"$entities",r),i=()=>fe(Oe,"$connection",r),[r,o]=Ee(),t=C(),l=C();let c=z(e,"entityId",8),d=z(e,"label",8,"");function g(){if(!i())return;const V=s(l)?"turn_off":"turn_on";Le(i(),"homeassistant",V,{entity_id:c()})}H(()=>(a(),A(c())),()=>{N(t,a()[c()])}),H(()=>s(t),()=>{N(l,s(t)?.state==="on")}),xe(),Se();var u=Ta(),_=f(u),$=f(_);Dt($,{size:32}),v(_);var w=E(_,2),I=f(w,!0);v(w);var h=E(w,2),b=f(h,!0);v(h),v(u),Q(()=>{Ae(u,1,`tile ${s(l)?"on":"off"} glass-panel`,"svelte-tiial9"),P(I,(A(d()),s(t),A(c()),B(()=>d()||s(t)?.attributes.friendly_name||c()))),P(b,(s(t),B(()=>s(t)?.state||"Unknown")))}),Fe("click",u,g),p(n,u),ke(),o()}var Ca=U('<h3 class="title svelte-3p7m1a"> </h3>'),Oa=U(', <span class="active-count svelte-3p7m1a"> </span>',1),Aa=U(', <span class="unavailable-count svelte-3p7m1a"> </span>',1),xa=U('<div class="summary svelte-3p7m1a"> <!> <!></div>'),Da=U('<div class="header svelte-3p7m1a"><!> <!></div>'),Pa=U('<div class="empty-state svelte-3p7m1a"><p>No sensors available</p></div>'),Ua=U('<div><div class="icon svelte-3p7m1a"><!></div> <div class="name svelte-3p7m1a"> </div> <div class="state svelte-3p7m1a"> </div></div>'),La=U('<div class="status-grid svelte-3p7m1a"></div>'),za=U('<div class="status-grid-container svelte-3p7m1a"><!> <!></div>');function Ra(n,e){we(e,!1);const a=()=>fe(Me,"$entities",i),[i,r]=Ee(),o=C(),t=C();let l=z(e,"entityIds",24,()=>[]),c=z(e,"labels",24,()=>({})),d=z(e,"deviceClass",8,"door"),g=z(e,"deviceClasses",24,()=>({})),u=z(e,"title",8,""),_=z(e,"showSummary",8,!1),$=z(e,"hideUnavailable",8,!1),w=z(e,"sortByState",8,!0);function I(S){switch(S){case"door":return"Open";case"window":return"Open";case"motion":return"Detected";case"garage":return"Open";case"problem":return"Problem";default:return"On"}}function h(S){switch(S){case"door":return"Closed";case"window":return"Closed";case"motion":return"Clear";case"garage":return"Closed";case"problem":return"OK";default:return"Off"}}function b(S){switch(S){case"door":return vn;case"window":return _t;case"motion":return fn;case"garage":return pt;default:return gn}}function V(S){switch(S){case"door":return un;case"window":return _t;case"motion":return mt;case"garage":return pt;default:return mt}}function te(S,k,m){return!S||S==="unavailable"||S==="unknown"?S==="unavailable"?"Unavailable":"Unknown":m?I(k):h(k)}function q(S,k,m){return!S||S==="unavailable"||S==="unknown"?Xs:m?b(k):V(k)}H(()=>(A(l()),a(),A(g()),A(d()),A($()),A(c()),A(w())),()=>{N(o,l().map(S=>{const k=a()[S],m=g()[S]??k?.attributes?.device_class??d(),y=k?.state,M=y==="on",x=!y||y==="unavailable"||y==="unknown";return $()&&x?null:{id:S,entity:k,label:c()[S]??k?.attributes?.friendly_name??S,deviceClass:m,state:y,isOn:M,isUnavailable:x,stateLabel:te(y,m,M),IconComponent:q(y,m,M)}}).filter(S=>S!==null).sort((S,k)=>{if(w()){if(S.isUnavailable&&!k.isUnavailable)return-1;if(!S.isUnavailable&&k.isUnavailable)return 1;if(S.isOn&&!k.isOn)return-1;if(!S.isOn&&k.isOn)return 1}return 0}))}),H(()=>(A(_()),s(o)),()=>{N(t,_()?(()=>{const S=s(o).length,k=s(o).filter(y=>y.isOn).length,m=s(o).filter(y=>y.isUnavailable).length;return{total:S,active:k,unavailable:m}})():null)}),xe(),Se();var se=za(),oe=f(se);{var Y=S=>{var k=Da(),m=f(k);{var y=L=>{var F=Ca(),K=f(F,!0);v(F),Q(()=>P(K,u())),p(L,F)};J(m,L=>{u()&&L(y)})}var M=E(m,2);{var x=L=>{var F=xa(),K=f(F),le=E(K);{var ye=Z=>{var de=Oa(),R=E(O(de)),ve=f(R);v(R),Q(()=>P(ve,`${s(t),B(()=>s(t).active)??""} active`)),p(Z,de)};J(le,Z=>{s(t),B(()=>s(t).active>0)&&Z(ye)})}var G=E(le,2);{var D=Z=>{var de=Aa(),R=E(O(de)),ve=f(R);v(R),Q(()=>P(ve,`${s(t),B(()=>s(t).unavailable)??""} unavailable`)),p(Z,de)};J(G,Z=>{s(t),B(()=>s(t).unavailable>0)&&Z(D)})}v(F),Q(()=>P(K,`${s(t),B(()=>s(t).total)??""} ${s(t),B(()=>s(t).total===1?"sensor":"sensors")??""} `)),p(L,F)};J(M,L=>{s(t)&&L(x)})}v(k),p(S,k)};J(oe,S=>{(u()||s(t))&&S(Y)})}var ce=E(oe,2);{var ee=S=>{var k=Pa();p(S,k)},X=S=>{var k=La();nt(k,5,()=>s(o),tt,(m,y)=>{let M=()=>s(y).label,x=()=>s(y).isOn,L=()=>s(y).isUnavailable,F=()=>s(y).stateLabel,K=()=>s(y).IconComponent;var le=Ua(),ye=f(le),G=f(ye);rn(G,K,(ve,$e)=>{$e(ve,{size:24})}),v(ye);var D=E(ye,2),Z=f(D,!0);v(D);var de=E(D,2),R=f(de,!0);v(de),v(le),Q(()=>{Ae(le,1,`tile glass-panel ${L()?"unavailable":x()?"active":"inactive"}`,"svelte-3p7m1a"),ut(le,"title",`${M()??""}: ${F()??""}`),P(Z,M()),P(R,F())}),p(m,le)}),v(k),p(S,k)};J(ce,S=>{s(o),B(()=>s(o).length===0)?S(ee):S(X,!1)})}v(se),p(n,se),ke(),r()}var Ha=U('<div class="header svelte-aryo9e"><div class="title svelte-aryo9e"><!> <span> </span></div></div>'),ja=U('<div class="loading svelte-aryo9e">Loading events...</div>'),Fa=U('<div class="error svelte-aryo9e"> </div>'),qa=U('<div class="empty svelte-aryo9e">No upcoming events <div class="debug-info" style="font-size: 0.7rem; opacity: 0.5; margin-top: 0.5rem;"> </div></div>'),Va=U('<span class="time-separator svelte-aryo9e">–</span> ',1),Ba=U('<span class="duration svelte-aryo9e"> </span>'),Ja=U('<div class="event-time svelte-aryo9e"><!> <span> <!></span> <!></div>'),Ga=U('<div class="event-time svelte-aryo9e"><!> <span> </span></div>'),Wa=U('<div class="event-location svelte-aryo9e"><!> <span> </span></div>'),Ka=U('<div class="event glass-panel svelte-aryo9e"><div class="event-date-time svelte-aryo9e"><div class="event-date svelte-aryo9e"><!> <span> </span></div> <!></div> <div class="event-title svelte-aryo9e"> </div> <!></div>'),Ya=U('<div class="events-list svelte-aryo9e"></div>'),Xa=U('<div class="tile calendar glass-panel svelte-aryo9e"><!> <div class="content svelte-aryo9e"><!></div></div>');function Za(n,e){we(e,!1);const a=()=>fe(Qe,"$connected",r),i=()=>fe(Oe,"$connection",r),[r,o]=Ee();let t=z(e,"entityId",8),l=z(e,"label",8,""),c=z(e,"maxEvents",8,5),d=z(e,"daysAhead",8,7),g=z(e,"showTitle",8,!0),u=C([]),_=C(!0),$=C(null),w=null,I=C(!1);async function h(){a()||await new Promise(m=>setTimeout(m,1e3));try{N(_,!0),N($,null);const m=new Date;m.setHours(0,0,0,0);const y=new Date(Date.now()+d()*24*60*60*1e3);y.setHours(23,59,59,999),console.log("Calendar date range:",{start:m.toISOString(),end:y.toISOString(),daysAhead:d()});const M=await Gs(t(),m,y);console.log("Fetched events:",M),console.log("Number of events:",M.length),M.length>0&&console.log("First event:",M[0]),N(u,M.map(x=>{const L=x.start?.dateTime||x.start?.date;if(!L)return{event:x,sortKey:1/0};let F;if(L.includes("T"))F=new Date(L);else{const[K,le,ye]=L.split("-").map(Number);F=new Date(K,le-1,ye,0,0,0,0)}return{event:x,sortKey:F.getTime()}}).sort((x,L)=>x.sortKey-L.sortKey).map(x=>x.event).slice(0,c())),console.log("Sorted events order:",s(u).map(x=>({summary:x.summary||x.title,date:V(x),start:x.start?.dateTime||x.start?.date}))),console.log("Processed events:",s(u).length)}catch(m){const y=m.message||"Failed to load events";N($,y),console.error("Calendar fetch error:",m),console.error("Entity ID:",t()),console.error("Error details:",{message:m.message,stack:m.stack,name:m.name}),N(u,[])}finally{N(_,!1)}}function b(m){const y=m.start?.date||m.start?.dateTime||m.start_time||m.dtstart||m.start;return y?typeof y=="string"&&!y.includes("T")&&!y.includes(" ")&&!!y.match(/^\d{4}-\d{2}-\d{2}$/):!1}function V(m){const y=m.start?.dateTime||m.start?.date||m.start_time||m.dtstart||m.start;if(!y)return console.warn("No start date found in event:",m),"";try{const M=new Date(y);if(isNaN(M.getTime()))return console.warn("Invalid date:",y),"";const x=new Date,L=new Date(x.getFullYear(),x.getMonth(),x.getDate()),F=new Date(M.getFullYear(),M.getMonth(),M.getDate());if(F.getTime()===L.getTime())return"Today";const K=new Date(L);if(K.setDate(K.getDate()+1),F.getTime()===K.getTime())return"Tomorrow";const le=Math.floor((F.getTime()-L.getTime())/(1e3*60*60*24));return le>=0&&le<7?M.toLocaleDateString("en-US",{weekday:"long"}):M.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}catch(M){return console.error("Error formatting date:",M,y),""}}function te(m){const y=m.start?.dateTime||m.start?.date||m.start_time||m.dtstart||m.start;if(!y)return"";if(b(m))return"All day";try{const M=new Date(y);return isNaN(M.getTime())?"":M.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}catch(M){return console.error("Error formatting time:",M,y),""}}function q(m){const y=m.end?.dateTime||m.end?.date||m.end_time||m.dtend||m.end;if(!y||b(m))return"";try{const M=new Date(y);return isNaN(M.getTime())?"":M.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}catch(M){return console.error("Error formatting end time:",M,y),""}}function se(m){const y=m.start?.dateTime||m.start?.date,M=m.end?.dateTime||m.end?.date;if(!y||!M)return"";const x=new Date(y),F=new Date(M).getTime()-x.getTime(),K=F/(1e3*60*60);return K<1?`${Math.round(F/6e4)}m`:K<24?`${Math.round(K*10)/10}h`:`${Math.round(K/24)}d`}Zt(()=>{h(),w=setInterval(()=>{N(I,!1),h()},300*1e3)}),An(()=>{w&&clearInterval(w)}),H(()=>(a(),i(),s(I)),()=>{a()&&i()&&!s(I)&&(N(I,!0),h())}),xe(),Se();var oe=Xa(),Y=f(oe);{var ce=m=>{var y=Ha(),M=f(y),x=f(M);Wt(x,{size:18});var L=E(x,2),F=f(L,!0);v(L),v(M),v(y),Q(()=>P(F,l()||"Calendar")),p(m,y)};J(Y,m=>{g()&&m(ce)})}var ee=E(Y,2),X=f(ee);{var S=m=>{var y=ja();p(m,y)},k=m=>{var y=j(),M=O(y);{var x=F=>{var K=Fa(),le=f(K,!0);v(K),Q(()=>P(le,s($))),p(F,K)},L=F=>{var K=j(),le=O(K);{var ye=D=>{var Z=qa(),de=E(f(Z)),R=f(de);v(de),v(Z),Q(()=>P(R,`Events fetched: ${s(u),B(()=>s(u).length)??""}`)),p(D,Z)},G=D=>{var Z=Ya();nt(Z,5,()=>s(u),tt,(de,R)=>{var ve=Ka(),$e=f(ve),qe=f($e),Te=f(qe);Wt(Te,{size:12});var Je=E(Te,2),T=f(Je,!0);v(Je),v(qe);var Ge=E(qe,2);{var st=ue=>{var ge=Ja(),_e=f(ge);Kt(_e,{size:12});var he=E(_e,2),ze=f(he),rt=E(ze);{var bt=Ie=>{var He=Va(),it=E(O(He));Q(Ce=>P(it,` ${Ce??""}`),[()=>(s(R),B(()=>q(s(R))))]),p(Ie,He)};J(rt,Ie=>{s(R),B(()=>q(s(R)))&&Ie(bt)})}v(he);var Re=E(he,2);{var vt=Ie=>{var He=Ba(),it=f(He);v(He),Q(Ce=>P(it,`(${Ce??""})`),[()=>(s(R),B(()=>se(s(R))))]),p(Ie,He)};J(Re,Ie=>{s(R),B(()=>se(s(R)))&&Ie(vt)})}v(ge),Q(Ie=>P(ze,`${Ie??""} `),[()=>(s(R),B(()=>te(s(R))||"Time TBD"))]),p(ue,ge)},at=ue=>{var ge=Ga(),_e=f(ge);Kt(_e,{size:12});var he=E(_e,2),ze=f(he,!0);v(he),v(ge),Q(rt=>P(ze,rt),[()=>(s(R),B(()=>te(s(R))||"All day"))]),p(ue,ge)};J(Ge,ue=>{s(R),B(()=>!b(s(R)))?ue(st):ue(at,!1)})}v($e);var De=E($e,2),Ne=f(De,!0);v(De);var W=E(De,2);{var be=ue=>{var ge=Wa(),_e=f(ge);ea(_e,{size:24});var he=E(_e,2),ze=f(he,!0);v(he),v(ge),Q(()=>P(ze,(s(R),B(()=>s(R).location)))),p(ue,ge)};J(W,ue=>{s(R),B(()=>s(R).location)&&ue(be)})}v(ve),Q(ue=>{P(T,ue),P(Ne,(s(R),B(()=>s(R).summary||s(R).title||"Untitled Event")))},[()=>(s(R),B(()=>V(s(R))||"Date TBD"))]),p(de,ve)}),v(Z),p(D,Z)};J(le,D=>{s(u),B(()=>s(u).length===0)?D(ye):D(G,!1)},!0)}p(F,K)};J(M,F=>{s($)?F(x):F(L,!1)},!0)}p(m,y)};J(X,m=>{s(_)?m(S):m(k,!1)})}v(ee),v(oe),p(n,oe),ke(),o()}var Qa=U('<div class="status error svelte-1uha8ag"> </div>'),er=U("<div> </div>"),tr=U('<div><div class="people"><div class="people-grid svelte-1uha8ag"></div></div></div>'),nr=U('<div class="status-grid-wrapper svelte-1uha8ag"><!></div>'),sr=U('<div class="calendar-tile-wrapper svelte-1uha8ag"><!></div>'),ar=U('<section class="section svelte-1uha8ag"><h2 class="svelte-1uha8ag"> </h2> <div class="grid svelte-1uha8ag"></div></section>'),rr=U('<div class="dashboard-container svelte-1uha8ag"><header class="svelte-1uha8ag"><div class="header-left svelte-1uha8ag"><div class="clock svelte-1uha8ag"><span class="time svelte-1uha8ag"> </span> <span class="date svelte-1uha8ag"> </span></div> <div class="status-container svelte-1uha8ag"><!> <button class="master-switch glass-panel svelte-1uha8ag" title="Turn Off All Lights &amp; Plugs"><!> <span>All Off</span></button> <button class="dark-mode-toggle glass-panel svelte-1uha8ag"><!></button></div></div> <!></header> <main><main></main></main></div>');function gr(n,e){we(e,!0);const a=()=>fe(Oe,"$connection",t),i=()=>fe(Me,"$entities",t),r=()=>fe(Ve,"$connectionError",t),o=()=>fe(Qe,"$connected",t),[t,l]=Ee();let c=Ft(es(new Date)),d=me(()=>s(c).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})),g=me(()=>s(c).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})),u=Ft(!1);function _(){N(u,!s(u)),typeof window<"u"&&(localStorage.setItem("darkMode",s(u).toString()),document.documentElement.classList.toggle("dark",s(u)))}Zt(()=>{console.log("Alakazam Dashboard: Initializing..."),console.log("Current URL:",typeof window<"u"?window.location.href:"N/A");try{Js()}catch(D){console.error("Error connecting to HA:",D)}const G=setInterval(()=>{N(c,new Date,!0)},1e3);if(typeof window<"u"){const D=localStorage.getItem("darkMode")==="true";N(u,D),D&&document.documentElement.classList.add("dark")}return()=>clearInterval(G)});function $(){if(!a())return;const G=Object.keys(i()).filter(D=>(D.startsWith("light.")||D.startsWith("switch."))&&i()[D].state==="on");G.length>0&&Le(a(),"homeassistant","turn_off",{entity_id:G})}const w=[{entityId:"person.artfuldoidger",label:"Mat",batteryEntityId:"sensor.mats_iphone_battery_level"},{entityId:"person.jessi",label:"Jess",batteryEntityId:"sensor.jessi_battery_level"}],I={Security:[{type:"statusGrid",entityIds:["binary_sensor.frontdoor_contact_sensor_contact"],labels:{"binary_sensor.frontdoor_contact_sensor_contact":"Front Door"},deviceClass:"door",showSummary:!1},{type:"arm",entityId:"input_boolean.nighttime_door_warning",label:"Arm Door Sensors"}],Calendar:[{type:"calendar",entityId:"calendar.mat_and_jessi",label:"Upcoming Events",maxEvents:5,daysAhead:1,showTitle:!1}],"Living Room":[{type:"media",entityId:"media_player.living_room_tv",label:"TV"},{type:"switch",entityId:"switch.innr_smart_plug_1",label:"Xmas TreeSmart Plug"}],"Master Bedroom":[{type:"light",entityId:"light.bedroom_lamp",label:"Mat Bedroom Lamp"},{type:"light",entityId:"light.mat_and_jess_light",label:"Mat & Jess Light Strip"},{type:"switch",entityId:"switch.0x0017880108e74ea6",label:"Mat & Jess Smart Plug"},{type:"media",entityId:"media_player.main_bedroom",label:"Apple TV"}],"Kids' Rooms":[{type:"light",entityId:"light.ellies_room",label:"Ellie's Light Bar"},{type:"media",entityId:"media_player.ellie_s_daddy_s_house",label:"Ellie's Yoto",temperatureEntityId:"sensor.ellie_s_daddy_s_house_temperature"},{type:"light",entityId:"light.poppys_light_strip_2",label:"Poppy's Light"},{type:"media",entityId:"media_player.poppy_s_yoto",label:"Poppy's Yoto",temperatureEntityId:"sensor.poppy_s_yoto_temperature"},{type:"light",entityId:"light.bens_bedside_lamp",label:"Ben's Lamp"}],Hallway:[{type:"binary_sensor",entityId:"binary_sensor.frontdoor_contact_sensor_contact",label:"Front Door",deviceClass:"door"},{type:"light",entityId:"light.hallway",label:"Hallway Light"}],Network:[{type:"sensor",entityId:"sensor.ucg_ultra_state",label:"UCG Ultra State"},{type:"sensor",entityId:"sensor.atom",label:"Atom Wifi",unit:"Clients"},{type:"sensor",entityId:"sensor.cerebro",label:"Cerebro Wifi",unit:"Clients"},{type:"sensor",entityId:"sensor.ucg_ultra_ucg_ultra_cpu_temperature",label:"UCG Ultra CPU Temp",unit:"°C"}],"Raspberry Pi Server":[{type:"sensor",entityId:"sensor.system_monitor_last_boot",label:"Last Boot",format:"date"},{type:"sensor",entityId:"sensor.system_monitor_disk_use",label:"Disk Use",unit:"%"},{type:"sensor",entityId:"sensor.system_monitor_disk_free",label:"Disk Free",unit:"GB"},{type:"sensor",entityId:"sensor.system_monitor_processor_temperature",label:"Processor Temp",unit:"°C"}]};var h=rr(),b=f(h),V=f(b),te=f(V),q=f(te),se=f(q,!0);v(q);var oe=E(q,2),Y=f(oe,!0);v(oe),v(te);var ce=E(te,2),ee=f(ce);{var X=G=>{var D=Qa(),Z=f(D,!0);v(D),Q(()=>{ut(D,"title",r()),P(Z,r())}),p(G,D)},S=G=>{var D=er();let Z;var de=f(D,!0);v(D),Q(()=>{Z=Ae(D,1,"status svelte-1uha8ag",null,Z,{connected:o()}),P(de,o()?"Connected":"Connecting...")}),p(G,D)};J(ee,G=>{r()?G(X):G(S,!1)})}var k=E(ee,2);k.__click=$;var m=f(k);hn(m,{size:20}),ts(2),v(k);var y=E(k,2);y.__click=_;var M=f(y);{var x=G=>{ra(G,{size:20})},L=G=>{ta(G,{size:20})};J(M,G=>{s(u)?G(x):G(L,!1)})}v(y),v(ce),v(V);var F=E(V,2);{var K=G=>{var D=tr(),Z=f(D),de=f(Z);nt(de,21,()=>w,tt,(R,ve)=>{$a(R,{get entityId(){return s(ve).entityId},get label(){return s(ve).label},get batteryEntityId(){return s(ve).batteryEntityId}})}),v(de),v(Z),v(D),p(G,D)};J(F,G=>{w.length>0&&G(K)})}v(b);var le=E(b,2),ye=f(le);nt(ye,21,()=>Object.entries(I),tt,(G,D)=>{var Z=me(()=>an(s(D),2));let de=()=>s(Z)[0],R=()=>s(Z)[1];var ve=ar(),$e=f(ve),qe=f($e,!0);v($e);var Te=E($e,2);nt(Te,21,R,tt,(Je,T)=>{var Ge=j(),st=O(Ge);{var at=Ne=>{da(Ne,{get entityId(){return s(T).entityId},get label(){return s(T).label}})},De=Ne=>{var W=j(),be=O(W);{var ue=_e=>{va(_e,{get entityId(){return s(T).entityId},get label(){return s(T).label},get unit(){return s(T).unit},get format(){return s(T).format}})},ge=_e=>{var he=j(),ze=O(he);{var rt=Re=>{ha(Re,{get entityId(){return s(T).entityId},get label(){return s(T).label},get deviceClass(){return s(T).deviceClass}})},bt=Re=>{var vt=j(),Ie=O(vt);{var He=Ce=>{_a(Ce,{get entityId(){return s(T).entityId},get label(){return s(T).label}})},it=Ce=>{var Pt=j(),_n=O(Pt);{var mn=We=>{Ma(We,{get entityId(){return s(T).entityId},get label(){return s(T).label}})},pn=We=>{var Ut=j(),yn=O(Ut);{var bn=Ke=>{Na(Ke,{get entityId(){return s(T).entityId},get label(){return s(T).label}})},$n=Ke=>{var Lt=j(),wn=O(Lt);{var kn=Ye=>{Ea(Ye,{get entityId(){return s(T).entityId},get label(){return s(T).label},get temperatureEntityId(){return s(T).temperatureEntityId}})},In=Ye=>{var zt=j(),En=O(zt);{var Sn=Xe=>{var Ze=nr(),$t=f(Ze);{let wt=me(()=>s(T).entityIds??[]),ot=me(()=>s(T).labels??{}),lt=me(()=>s(T).deviceClass??"door"),kt=me(()=>s(T).deviceClasses??{}),It=me(()=>s(T).title??""),Et=me(()=>s(T).showSummary??!1),St=me(()=>s(T).hideUnavailable??!1),Mt=me(()=>s(T).sortByState??!0);Ra($t,{get entityIds(){return s(wt)},get labels(){return s(ot)},get deviceClass(){return s(lt)},get deviceClasses(){return s(kt)},get title(){return s(It)},get showSummary(){return s(Et)},get hideUnavailable(){return s(St)},get sortByState(){return s(Mt)}})}v(Ze),p(Xe,Ze)},Mn=Xe=>{var Ze=j(),$t=O(Ze);{var wt=ot=>{var lt=sr(),kt=f(lt);{let It=me(()=>s(T).label??""),Et=me(()=>s(T).maxEvents??5),St=me(()=>s(T).daysAhead??7),Mt=me(()=>s(T).showTitle!==void 0?s(T).showTitle:!0);Za(kt,{get entityId(){return s(T).entityId},get label(){return s(It)},get maxEvents(){return s(Et)},get daysAhead(){return s(St)},get showTitle(){return s(Mt)}})}v(lt),p(ot,lt)};J($t,ot=>{s(T).type==="calendar"&&ot(wt)},!0)}p(Xe,Ze)};J(En,Xe=>{s(T).type==="statusGrid"?Xe(Sn):Xe(Mn,!1)},!0)}p(Ye,zt)};J(wn,Ye=>{s(T).type==="media"?Ye(kn):Ye(In,!1)},!0)}p(Ke,Lt)};J(yn,Ke=>{s(T).type==="automation"?Ke(bn):Ke($n,!1)},!0)}p(We,Ut)};J(_n,We=>{s(T).type==="arm"?We(mn):We(pn,!1)},!0)}p(Ce,Pt)};J(Ie,Ce=>{s(T).type==="switch"?Ce(He):Ce(it,!1)},!0)}p(Re,vt)};J(ze,Re=>{s(T).type==="binary_sensor"?Re(rt):Re(bt,!1)},!0)}p(_e,he)};J(be,_e=>{s(T).type==="sensor"?_e(ue):_e(ge,!1)},!0)}p(Ne,W)};J(st,Ne=>{s(T).type==="light"?Ne(at):Ne(De,!1)})}p(Je,Ge)}),v(Te),v(ve),Q(()=>P(qe,de())),p(G,ve)}),v(ye),v(le),v(h),Q(()=>{P(se,s(d)),P(Y,s(g)),ut(y,"title",s(u)?"Switch to Light Mode":"Switch to Dark Mode")}),p(n,h),ke(),l()}On(["click"]);export{gr as component};
